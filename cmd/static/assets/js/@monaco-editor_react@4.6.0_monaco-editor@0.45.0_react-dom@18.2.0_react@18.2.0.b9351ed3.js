import{l as e}from"./@monaco-editor_loader@1.4.0_monaco-editor@0.45.0.bb883f0d.js";import{r as t,W as r}from"./react@18.2.0.2fdb0b9b.js";var n={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},u={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}};var l=function({children:e}){return r.createElement("div",{style:u.container},e)};var i=function({width:e,height:t,isEditorReady:u,loading:i,_ref:o,className:a,wrapperProps:c}){return r.createElement("section",{style:{...n.wrapper,width:e,height:t},...c},!u&&r.createElement(l,null,i),r.createElement("div",{ref:o,style:{...n.fullWidth,...!u&&n.hide},className:a}))},o=t.memo(i);var a=function(e){t.useEffect(e,[])};var c=function(e,r,n=!0){let u=t.useRef(!0);t.useEffect(u.current||!n?()=>{u.current=!1}:e,r)};function d(){}function s(e,t,r,n){return function(e,t){return e.editor.getModel(f(e,t))}(e,n)||function(e,t,r,n){return e.editor.createModel(t,r,n?f(e,n):void 0)}(e,t,r,n)}function f(e,t){return e.Uri.parse(t)}var g=function({original:n,modified:u,language:l,originalLanguage:i,modifiedLanguage:f,originalModelPath:g,modifiedModelPath:p,keepCurrentOriginalModel:v=!1,keepCurrentModifiedModel:h=!1,theme:M="light",loading:m="Loading...",options:E={},height:R="100%",width:w="100%",className:y,wrapperProps:x={},beforeMount:V=d,onMount:L=d}){let[S,C]=t.useState(!1),[k,O]=t.useState(!0),P=t.useRef(null),N=t.useRef(null),b=t.useRef(null),_=t.useRef(L),T=t.useRef(V),j=t.useRef(!1);a((()=>{let t=e.init();return t.then((e=>(N.current=e)&&O(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&void 0)),()=>P.current?function(){var e,t,r,n;let u=null==(e=P.current)?void 0:e.getModel();v||null==(t=null==u?void 0:u.original)||t.dispose(),h||null==(r=null==u?void 0:u.modified)||r.dispose(),null==(n=P.current)||n.dispose()}():t.cancel()})),c((()=>{if(P.current&&N.current){let e=P.current.getOriginalEditor(),t=s(N.current,n||"",i||l||"text",g||"");t!==e.getModel()&&e.setModel(t)}}),[g],S),c((()=>{if(P.current&&N.current){let e=P.current.getModifiedEditor(),t=s(N.current,u||"",f||l||"text",p||"");t!==e.getModel()&&e.setModel(t)}}),[p],S),c((()=>{let e=P.current.getModifiedEditor();e.getOption(N.current.editor.EditorOption.readOnly)?e.setValue(u||""):u!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:u||"",forceMoveMarkers:!0}]),e.pushUndoStop())}),[u],S),c((()=>{var e,t;null==(t=null==(e=P.current)?void 0:e.getModel())||t.original.setValue(n||"")}),[n],S),c((()=>{let{original:e,modified:t}=P.current.getModel();N.current.editor.setModelLanguage(e,i||l||"text"),N.current.editor.setModelLanguage(t,f||l||"text")}),[l,i,f],S),c((()=>{var e;null==(e=N.current)||e.editor.setTheme(M)}),[M],S),c((()=>{var e;null==(e=P.current)||e.updateOptions(E)}),[E],S);let D=t.useCallback((()=>{var e;if(!N.current)return;T.current(N.current);let t=s(N.current,n||"",i||l||"text",g||""),r=s(N.current,u||"",f||l||"text",p||"");null==(e=P.current)||e.setModel({original:t,modified:r})}),[l,u,f,n,i,g,p]),F=t.useCallback((()=>{var e;!j.current&&b.current&&(P.current=N.current.editor.createDiffEditor(b.current,{automaticLayout:!0,...E}),D(),null==(e=N.current)||e.editor.setTheme(M),C(!0),j.current=!0)}),[E,M,D]);return t.useEffect((()=>{S&&_.current(P.current,N.current)}),[S]),t.useEffect((()=>{!k&&!S&&F()}),[k,S,F]),r.createElement(o,{width:w,height:R,isEditorReady:S,loading:m,_ref:b,className:y,wrapperProps:x})};t.memo(g);var p=function(e){let r=t.useRef();return t.useEffect((()=>{r.current=e}),[e]),r.current},v=new Map;var h=function({defaultValue:n,defaultLanguage:u,defaultPath:l,value:i,language:f,path:g,theme:h="light",line:M,loading:m="Loading...",options:E={},overrideServices:R={},saveViewState:w=!0,keepCurrentModel:y=!1,width:x="100%",height:V="100%",className:L,wrapperProps:S={},beforeMount:C=d,onMount:k=d,onChange:O,onValidate:P=d}){let[N,b]=t.useState(!1),[_,T]=t.useState(!0),j=t.useRef(null),D=t.useRef(null),F=t.useRef(null),U=t.useRef(k),W=t.useRef(C),A=t.useRef(),I=t.useRef(i),q=p(g),z=t.useRef(!1),B=t.useRef(!1);a((()=>{let t=e.init();return t.then((e=>(j.current=e)&&T(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&void 0)),()=>{return D.current?(null==(e=A.current)||e.dispose(),y?w&&v.set(g,D.current.saveViewState()):null==(r=D.current.getModel())||r.dispose(),void D.current.dispose()):t.cancel();var e,r}})),c((()=>{var e,t,r,o;let a=s(j.current,n||i||"",u||f||"",g||l||"");a!==(null==(e=D.current)?void 0:e.getModel())&&(w&&v.set(q,null==(t=D.current)?void 0:t.saveViewState()),null==(r=D.current)||r.setModel(a),w&&(null==(o=D.current)||o.restoreViewState(v.get(g))))}),[g],N),c((()=>{var e;null==(e=D.current)||e.updateOptions(E)}),[E],N),c((()=>{!D.current||void 0===i||(D.current.getOption(j.current.editor.EditorOption.readOnly)?D.current.setValue(i):i!==D.current.getValue()&&(B.current=!0,D.current.executeEdits("",[{range:D.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),D.current.pushUndoStop(),B.current=!1))}),[i],N),c((()=>{var e,t;let r=null==(e=D.current)?void 0:e.getModel();r&&f&&(null==(t=j.current)||t.editor.setModelLanguage(r,f))}),[f],N),c((()=>{var e;void 0!==M&&(null==(e=D.current)||e.revealLine(M))}),[M],N),c((()=>{var e;null==(e=j.current)||e.editor.setTheme(h)}),[h],N);let G=t.useCallback((()=>{var e;if(F.current&&j.current&&!z.current){W.current(j.current);let t=g||l,r=s(j.current,i||n||"",u||f||"",t||"");D.current=null==(e=j.current)?void 0:e.editor.create(F.current,{model:r,automaticLayout:!0,...E},R),w&&D.current.restoreViewState(v.get(t)),j.current.editor.setTheme(h),void 0!==M&&D.current.revealLine(M),b(!0),z.current=!0}}),[n,u,l,i,f,g,E,R,w,h,M]);return t.useEffect((()=>{N&&U.current(D.current,j.current)}),[N]),t.useEffect((()=>{!_&&!N&&G()}),[_,N,G]),I.current=i,t.useEffect((()=>{var e,t;N&&O&&(null==(e=A.current)||e.dispose(),A.current=null==(t=D.current)?void 0:t.onDidChangeModelContent((e=>{B.current||O(D.current.getValue(),e)})))}),[N,O]),t.useEffect((()=>{if(N){let e=j.current.editor.onDidChangeMarkers((e=>{var t;let r=null==(t=D.current.getModel())?void 0:t.uri;if(r&&e.find((e=>e.path===r.path))){let e=j.current.editor.getModelMarkers({resource:r});null==P||P(e)}}));return()=>{null==e||e.dispose()}}return()=>{}}),[N,P]),r.createElement(o,{width:x,height:V,isEditorReady:N,loading:m,_ref:F,className:L,wrapperProps:S})},M=t.memo(h);export{M as F};
