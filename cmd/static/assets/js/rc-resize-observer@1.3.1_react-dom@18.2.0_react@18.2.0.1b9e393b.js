import{q as e,r as t,a as r,_ as n,d as o,h as u}from"./@babel_runtime@7.22.15.d775819b.js";import{r as i}from"./react@18.2.0.2fdb0b9b.js";import{s as a,m as f,J as c,x as s}from"./rc-util@5.37.0_react-dom@18.2.0_react@18.2.0.0a514d36.js";import{i as l}from"./resize-observer-polyfill@1.5.1.ad543aa3.js";var h=new Map;var d=new l((function(e){e.forEach((function(e){var t,r=e.target;null===(t=h.get(r))||void 0===t||t.forEach((function(e){return e(r)}))}))}));var v=function(o){e(i,o);var u=t(i);function i(){return r(this,i),u.apply(this,arguments)}return n(i,[{key:"render",value:function(){return this.props.children}}]),i}(i.Component),m=i.createContext(null);function p(e,t){var r=e.children,n=e.disabled,u=i.useRef(null),s=i.useRef(null),l=i.useContext(m),p="function"==typeof r,g=p?r(u):r,R=i.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),b=!p&&i.isValidElement(g)&&a(g),w=b?g.ref:null,y=i.useMemo((function(){return f(w,u)}),[w,u]),C=function(){return c(u.current)||c(s.current)};i.useImperativeHandle(t,(function(){return C()}));var E=i.useRef(e);E.current=e;var k=i.useCallback((function(e){var t=E.current,r=t.onResize,n=t.data,u=e.getBoundingClientRect(),i=u.width,a=u.height,f=e.offsetWidth,c=e.offsetHeight,s=Math.floor(i),h=Math.floor(a);if(R.current.width!==s||R.current.height!==h||R.current.offsetWidth!==f||R.current.offsetHeight!==c){var d={width:s,height:h,offsetWidth:f,offsetHeight:c};R.current=d;var v=f===Math.round(i)?i:f,m=c===Math.round(a)?a:c,p=o(o({},d),{},{offsetWidth:v,offsetHeight:m});null==l||l(p,e,n),r&&Promise.resolve().then((function(){r(p,e)}))}}),[]);return i.useEffect((function(){var e,t,r=C();return r&&!n&&(e=r,t=k,h.has(e)||(h.set(e,new Set),d.observe(e)),h.get(e).add(t)),function(){return function(e,t){h.has(e)&&(h.get(e).delete(t),h.get(e).size||(d.unobserve(e),h.delete(e)))}(r,k)}}),[u.current,n]),i.createElement(v,{ref:s},b?i.cloneElement(g,{ref:y}):g)}var g=i.forwardRef(p);function R(e,t){var r=e.children;return("function"==typeof r?[r]:s(r)).map((function(r,n){var o=(null==r?void 0:r.key)||"".concat("rc-observer-key","-").concat(n);return i.createElement(g,u({},e,{key:o,ref:0===n?t:void 0}),r)}))}var b=i.forwardRef(R);b.Collection=function(e){var t=e.children,r=e.onBatchResize,n=i.useRef(0),o=i.useRef([]),u=i.useContext(m),a=i.useCallback((function(e,t,i){n.current+=1;var a=n.current;o.current.push({size:e,element:t,data:i}),Promise.resolve().then((function(){a===n.current&&(null==r||r(o.current),o.current=[])})),null==u||u(e,t,i)}),[r,u]);return i.createElement(m.Provider,{value:a},t)};export{b as R};
